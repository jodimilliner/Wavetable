<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Wavetable Synth (Prophet‑style)</title>
    <style>
      :root { --bg:#141414; --panel:#1f1f1f; --panel-border:#2b2b2b; --text:#e6e6e6; --muted:#a8a8a8; --accent:#d1a15d; --slider-fill:#d1a15d; --slider-track:#2a2a2a; }
      html,body{height:100%}
      body{background:var(--bg);color:var(--text);margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
      .frame{max-width:1100px;margin:24px auto;padding:16px 16px 28px;background:linear-gradient(180deg,#222,#1a1a1a);border:2px solid #000;box-shadow:0 10px 30px rgba(0,0,0,.4),inset 0 0 0 1px #333;border-radius:6px}
      .header{display:flex;align-items:baseline;justify-content:space-between;padding:6px 8px 14px;border-bottom:1px solid #333;margin-bottom:12px}
      .brand{font-weight:700;letter-spacing:.08em;font-size:22px}
      .model{color:var(--muted);font-size:14px;letter-spacing:.15em}
      .panels{display:grid;grid-template-columns:repeat(12,1fr);gap:10px}
      .panel{background:var(--panel);border:1px solid var(--panel-border);border-radius:6px;padding:10px 10px 12px;box-shadow:inset 0 0 0 1px rgba(255,255,255,.02)}
      .panel h3{margin:0 0 10px;font-size:13px;font-weight:600;text-transform:uppercase;letter-spacing:.12em;color:var(--muted)}
      .row{display:flex;align-items:center;gap:10px;margin:8px 0}
      .row label{width:90px;color:var(--muted);font-size:12px;text-transform:uppercase;letter-spacing:.08em}
      .kv{color:var(--muted);font-variant-numeric:tabular-nums;min-width:56px;text-align:right;font-size:12px}
      input[type=range]{appearance:none;width:220px;height:6px;background:var(--slider-track);border-radius:4px;outline:none}
      input[type=range]::-webkit-slider-thumb{appearance:none;width:14px;height:14px;border-radius:50%;background:var(--slider-fill);border:1px solid #000;box-shadow:0 0 0 2px #000 inset;cursor:pointer}
      input[type=range]::-moz-range-thumb{width:14px;height:14px;border-radius:50%;background:var(--slider-fill);border:1px solid #000;cursor:pointer}
      .kbd{background:#0f0f0f;border:1px solid #000;border-radius:6px;padding:16px 10px;margin-top:16px;box-shadow:inset 0 0 0 1px #222}
      .keys{position:relative;width:100%;max-width:900px;margin:0 auto;height:140px}
      .whites{display:flex;height:140px}
      .white.key{flex:1;background:linear-gradient(#fff,#eaeaea);border:1px solid #222;border-bottom:6px solid #222;margin:0 2px;border-radius:0 0 4px 4px;position:relative}
      .black.key{position:absolute;width:8%;min-width:28px;height:90px;background:#111;border:1px solid #000;border-bottom:4px solid #000;top:0;border-radius:0 0 4px 4px;transform:translateX(-50%)}
      .keylabel{position:absolute;bottom:6px;left:6px;font-size:11px;color:#333}
      .down{outline:2px solid var(--accent);outline-offset:-2px}
      #piano{display:none}
      .muted{color:var(--muted);font-size:12px}
    </style>
  </head>
  <body>
    <div class="frame">
      <div class="header"><div class="brand">Prophet‑5</div><div class="model">Wavetable | Soundpipe + WASM</div></div>
      <div class="panels">
        <div class="panel" style="grid-column: span 4;">
          <h3>Osc 1</h3>
          <div class="row"><label>Wave</label><select id="wave1"><option value="0">Sine</option><option value="1">Saw</option><option value="2">Square</option><option value="3">Triangle</option><option value="4">FM</option></select></div>
          <div class="row"><label>Detune</label><input id="det1" type="range" min="-24" max="24" step="0.01" value="0" /><span id="det1Val" class="kv">0.00 st</span></div>
          <div class="row"><label>Gain</label><input id="gain1" type="range" min="0" max="1.5" step="0.01" value="0.5" /><span id="gain1Val" class="kv">0.50</span></div>
          <div class="row fm1"><label>FM Car</label><input id="fm1car" type="range" min="0.1" max="8" step="0.01" value="1.0" /><span id="fm1carVal" class="kv">1.00</span></div>
          <div class="row fm1"><label>FM Mod</label><input id="fm1mod" type="range" min="0.1" max="8" step="0.01" value="1.0" /><span id="fm1modVal" class="kv">1.00</span></div>
          <div class="row fm1"><label>FM Index</label><input id="fm1idx" type="range" min="0" max="10" step="0.01" value="2.0" /><span id="fm1idxVal" class="kv">2.00</span></div>
        </div>
        <div class="panel" style="grid-column: span 4;">
          <h3>Osc 2</h3>
          <div class="row"><label>Wave</label><select id="wave2"><option value="0">Sine</option><option value="1">Saw</option><option value="2">Square</option><option value="3">Triangle</option><option value="4">FM</option></select></div>
          <div class="row"><label>Detune</label><input id="det2" type="range" min="-24" max="24" step="0.01" value="0" /><span id="det2Val" class="kv">0.00 st</span></div>
          <div class="row"><label>Gain</label><input id="gain2" type="range" min="0" max="1.5" step="0.01" value="0.5" /><span id="gain2Val" class="kv">0.50</span></div>
          <div class="row fm2"><label>FM Car</label><input id="fm2car" type="range" min="0.1" max="8" step="0.01" value="1.0" /><span id="fm2carVal" class="kv">1.00</span></div>
          <div class="row fm2"><label>FM Mod</label><input id="fm2mod" type="range" min="0.1" max="8" step="0.01" value="1.0" /><span id="fm2modVal" class="kv">1.00</span></div>
          <div class="row fm2"><label>FM Index</label><input id="fm2idx" type="range" min="0" max="10" step="0.01" value="2.0" /><span id="fm2idxVal" class="kv">2.00</span></div>
        </div>
        <div class="panel" style="grid-column: span 4;">
          <h3>Poly & Master</h3>
          <div class="row"><label>Poly</label><input id="poly" type="range" min="1" max="16" step="1" value="8" /><span id="polyVal" class="kv">8 voices</span></div>
          <div class="row"><label>Master</label><input id="master" type="range" min="0" max="1.5" step="0.01" value="0.40" /><span id="masterVal" class="kv">0.40</span></div>
        </div>
        <div class="panel" style="grid-column: span 5;">
          <h3>Filter</h3>
          <div class="row"><label>Cutoff</label><input id="fc" type="range" min="20" max="12000" step="1" value="1200" /><span id="fcVal" class="kv">1.2 kHz</span></div>
          <div class="row"><label>Resonance</label><input id="res" type="range" min="0" max="1" step="0.01" value="0.30" /><span id="resVal" class="kv">0.30</span></div>
          <div class="row"><label>Env Amt</label><input id="famt" type="range" min="-8000" max="8000" step="1" value="2000" /><span id="famtVal" class="kv">+2000 Hz</span></div>
        </div>
        <div class="panel" style="grid-column: span 4;">
          <h3>LFO (Pitch)</h3>
          <div class="row"><label>Rate</label><input id="lforate" type="range" min="0" max="20" step="0.01" value="5" /><span id="lforVal" class="kv">5.00 Hz</span></div>
          <div class="row"><label>Amount</label><input id="lfoamnt" type="range" min="-12" max="12" step="0.1" value="0" /><span id="lfoaVal" class="kv">0.0 st</span></div>
        </div>
        <div class="panel" style="grid-column: span 6;">
          <h3>Amp Envelope</h3>
          <div class="row"><label>Attack</label><input id="atk" type="range" min="0" max="2" step="0.005" value="0.01" /><span id="atkVal" class="kv">0.01 s</span></div>
          <div class="row"><label>Decay</label><input id="dec" type="range" min="0" max="2" step="0.005" value="0.10" /><span id="decVal" class="kv">0.10 s</span></div>
          <div class="row"><label>Sustain</label><input id="sus" type="range" min="0" max="1" step="0.01" value="0.80" /><span id="susVal" class="kv">0.80</span></div>
          <div class="row"><label>Release</label><input id="rel" type="range" min="0" max="3" step="0.005" value="0.20" /><span id="relVal" class="kv">0.20 s</span></div>
        </div>
        <div class="panel" style="grid-column: span 6;">
          <h3>Filter Envelope</h3>
          <div class="row"><label>Attack</label><input id="fatk" type="range" min="0" max="2" step="0.005" value="0.005" /><span id="fatkVal" class="kv">0.005 s</span></div>
          <div class="row"><label>Decay</label><input id="fdec" type="range" min="0" max="2" step="0.005" value="0.150" /><span id="fdecVal" class="kv">0.150 s</span></div>
          <div class="row"><label>Sustain</label><input id="fsus" type="range" min="0" max="1" step="0.01" value="0.00" /><span id="fsusVal" class="kv">0.00</span></div>
          <div class="row"><label>Release</label><input id="frel" type="range" min="0" max="3" step="0.005" value="0.250" /><span id="frelVal" class="kv">0.250 s</span></div>
        </div>
      </div>
      <div class="kbd">
        <!-- <div class="muted" style="margin:0 0 8px 6px;">Keyboard (Z S X D C V G B H N J M ,)</div> -->
        <div class="keys" id="keys">
          <div class="whites">
            <div class="white key" data-key="a" data-midi="60"><div class="keylabel">A</div></div>
            <div class="white key" data-key="s" data-midi="62"><div class="keylabel">S</div></div>
            <div class="white key" data-key="d" data-midi="64"><div class="keylabel">D</div></div>
            <div class="white key" data-key="f" data-midi="65"><div class="keylabel">F</div></div>
            <div class="white key" data-key="g" data-midi="67"><div class="keylabel">G</div></div>
            <div class="white key" data-key="h" data-midi="69"><div class="keylabel">H</div></div>
            <div class="white key" data-key="j" data-midi="71"><div class="keylabel">J</div></div>
            <div class="white key" data-key="k" data-midi="72"><div class="keylabel">K</div></div>
          </div>
          <!-- approximate positions over 8 white keys (C..C) -->
          <div class="black key" style="left:14%;" data-key="w" data-midi="61"></div>
          <div class="black key" style="left:26.5%;" data-key="e" data-midi="63"></div>
          <div class="black key" style="left:51.0%;" data-key="t" data-midi="66"></div>
          <div class="black key" style="left:63.5%;" data-key="y" data-midi="68"></div>
          <div class="black key" style="left:76.0%;" data-key="u" data-midi="70"></div>
        </div>
      </div>
      <div style="margin-top:12px;" class="muted">Status: <span id="status"></span></div>
      <div id="log" style="display:none;"></div>
    </div>
    <script src="main.js"></script>
  </body>
  </html>
